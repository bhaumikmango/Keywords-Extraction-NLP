<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Keyword Extractor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            flex: 1;
        }

        .input-section, .results-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #4a5568;
        }

        .sample-selector {
            margin-bottom: 20px;
        }

        .sample-selector select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            background: white;
            transition: all 0.3s ease;
        }

        .sample-selector select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .text-input {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            transition: all 0.3s ease;
            background: white;
        }

        .text-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }

        .keyword-count {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .keyword-count input {
            width: 70px;
            padding: 8px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            text-align: center;
            font-size: 1rem;
        }

        .extract-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .extract-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .extract-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            color: #667eea;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .keywords-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .keyword-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .keyword-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
        }

        .keyword-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.3);
        }

        .keyword-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .keyword-score {
            font-size: 0.9rem;
            opacity: 0.9;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .download-btn {
            background: #48bb78;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .download-btn:hover {
            background: #38a169;
            transform: translateY(-2px);
        }

        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .success {
            background: #c6f6d5;
            color: #2d7d32;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #a0aec0;
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #4a5568;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .extract-btn {
                justify-content: center;
            }
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #718096;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .tab:hover {
            color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const sampleTexts = {
            "": "",
            "Machine Learning Research": "Machine learning algorithms have revolutionized the field of artificial intelligence by enabling computers to learn patterns from data without explicit programming. Deep neural networks, particularly convolutional neural networks, have shown remarkable performance in image recognition tasks. Natural language processing applications using transformer architectures have achieved state-of-the-art results in various linguistic tasks including sentiment analysis, machine translation, and text summarization.",
            "Climate Change Article": "Climate change represents one of the most pressing challenges of our time, with global temperatures rising at an unprecedented rate due to greenhouse gas emissions. The melting of polar ice caps and glaciers contributes to sea level rise, threatening coastal communities worldwide. Renewable energy technologies, including solar panels and wind turbines, offer promising solutions to reduce carbon dioxide emissions and mitigate the effects of global warming.",
            "Medical Research": "Recent advances in biomedical research have led to breakthrough treatments for various diseases. Gene therapy techniques using CRISPR technology allow precise editing of DNA sequences to correct genetic disorders. Immunotherapy approaches harness the body's immune system to fight cancer cells more effectively than traditional chemotherapy. Personalized medicine based on genetic profiles promises to revolutionize healthcare delivery."
        };

        
        const extractKeywords = async (text, numKeywords) => {
            const response = await fetch('/api/extract', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                text: text,
                numKeywords: numKeywords
                }),
            });
    
            if (!response.ok) {
                throw new Error('Failed to extract keywords');
            }
    
            return await response.json();
        };

        const BarChart = ({ keywords }) => {
            const canvasRef = React.useRef(null);
            const chartRef = React.useRef(null);

            useEffect(() => {
                if (!keywords || Object.keys(keywords).length === 0) return;

                const ctx = canvasRef.current.getContext('2d');
                
                if (chartRef.current) {
                    chartRef.current.destroy();
                }

                const labels = Object.keys(keywords);
                const data = Object.values(keywords);

                chartRef.current = new Chart(ctx, {
                    type: 'horizontalBar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'TF-IDF Score',
                            data: data,
                            backgroundColor: 'rgba(102, 126, 234, 0.8)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                beginAtZero: true
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });

                return () => {
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }
                };
            }, [keywords]);

            return <canvas ref={canvasRef} height="300"></canvas>;
        };

        const KeywordExtractor = () => {
            const [text, setText] = useState('');
            const [numKeywords, setNumKeywords] = useState(10);
            const [keywords, setKeywords] = useState({});
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const [success, setSuccess] = useState('');
            const [activeTab, setActiveTab] = useState('list');

            const handleSampleSelect = (e) => {
                setText(sampleTexts[e.target.value]);
            };

            const handleExtract = async () => {
                if (!text.trim()) {
                    setError('Please enter some text to analyze.');
                    return;
                }

                setLoading(true);
                setError('');
                setSuccess('');

                try {
                    const result = await extractKeywords(text, numKeywords);
                    setKeywords(result);
                    setSuccess(`Successfully extracted ${Object.keys(result).length} keywords!`);
                } catch (err) {
                    setError('Failed to extract keywords. Please try again.');
                } finally {
                    setLoading(false);
                }
            };

            const downloadCSV = () => {
                const csv = 'Keyword,TF-IDF Score\n' + 
                    Object.entries(keywords)
                        .map(([keyword, score]) => `"${keyword}",${score}`)
                        .join('\n');
                
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = 'keywords.csv';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            };

            return (
                <div className="container">
                    <div className="header">
                        <h1><i className="fas fa-search"></i> AI Keyword Extractor</h1>
                        <p>Extract meaningful keywords from any text using advanced TF-IDF analysis</p>
                    </div>

                    <div className="main-content">
                        <div className="input-section">
                            <h2 className="section-title">
                                <i className="fas fa-edit"></i>
                                Enter Your Text
                            </h2>

                            <div className="sample-selector">
                                <select onChange={handleSampleSelect} defaultValue="">
                                    <option value="">Select a sample text...</option>
                                    {Object.keys(sampleTexts).filter(key => key !== "").map(key => (
                                        <option key={key} value={key}>{key}</option>
                                    ))}
                                </select>
                            </div>

                            <textarea
                                className="text-input"
                                value={text}
                                onChange={(e) => setText(e.target.value)}
                                placeholder="Paste your article, research paper, or any text content here..."
                            />

                            <div className="controls">
                                <div className="keyword-count">
                                    <label>Keywords:</label>
                                    <input
                                        type="number"
                                        min="5"
                                        max="20"
                                        value={numKeywords}
                                        onChange={(e) => setNumKeywords(parseInt(e.target.value))}
                                    />
                                </div>

                                <button
                                    className="extract-btn"
                                    onClick={handleExtract}
                                    disabled={loading}
                                >
                                    {loading ? (
                                        <>
                                            <div className="spinner"></div>
                                            Analyzing...
                                        </>
                                    ) : (
                                        <>
                                            <i className="fas fa-rocket"></i>
                                            Extract Keywords
                                        </>
                                    )}
                                </button>
                            </div>

                            {error && (
                                <div className="error">
                                    <i className="fas fa-exclamation-triangle"></i>
                                    {error}
                                </div>
                            )}

                            {success && (
                                <div className="success">
                                    <i className="fas fa-check-circle"></i>
                                    {success}
                                </div>
                            )}
                        </div>

                        <div className="results-section">
                            <h2 className="section-title">
                                <i className="fas fa-chart-bar"></i>
                                Results
                            </h2>

                            {Object.keys(keywords).length > 0 ? (
                                <>
                                    <div className="tabs">
                                        <button 
                                            className={`tab ${activeTab === 'list' ? 'active' : ''}`}
                                            onClick={() => setActiveTab('list')}
                                        >
                                            <i className="fas fa-list"></i> Keywords
                                        </button>
                                        <button 
                                            className={`tab ${activeTab === 'chart' ? 'active' : ''}`}
                                            onClick={() => setActiveTab('chart')}
                                        >
                                            <i className="fas fa-chart-bar"></i> Chart
                                        </button>
                                    </div>

                                    {activeTab === 'list' && (
                                        <div className="keywords-grid">
                                            {Object.entries(keywords).map(([keyword, score]) => (
                                                <div key={keyword} className="keyword-card">
                                                    <div className="keyword-text">{keyword}</div>
                                                    <div className="keyword-score">Score: {score.toFixed(3)}</div>
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    {activeTab === 'chart' && (
                                        <div className="chart-container">
                                            <BarChart keywords={keywords} />
                                        </div>
                                    )}

                                    <button className="download-btn" onClick={downloadCSV}>
                                        <i className="fas fa-download"></i>
                                        Download CSV
                                    </button>
                                </>
                            ) : (
                                <div className="empty-state">
                                    <i className="fas fa-search"></i>
                                    <h3>No Keywords Yet</h3>
                                    <p>Enter some text and click "Extract Keywords" to see results here.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<KeywordExtractor />, document.getElementById('root'));
    </script>
</body>
</html>